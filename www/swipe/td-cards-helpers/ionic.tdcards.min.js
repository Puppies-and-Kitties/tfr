!function(t){for(var i=document.createElement("div"),n=["webkitTransformOrigin","transform-origin","-webkit-transform-origin","webkit-transform-origin","-moz-transform-origin","moz-transform-origin","MozTransformOrigin","mozTransformOrigin"],e="webkitTransformOrigin",r=0;r<n.length;r++)if(void 0!==i.style[n[r]]){e=n[r]
break}for(var o=["webkitTransition","transition","-webkit-transition","webkit-transition","-moz-transition","moz-transition","MozTransition","mozTransition"],s="webkitTransition",r=0;r<o.length;r++)if(void 0!==i.style[o[r]]){s=o[r]
break}var a=t.views.View.inherit({initialize:function(i){i=t.extend({},i),t.extend(this,i),this.el=i.el,this.parentWidth=this.el.parentNode.offsetWidth,this.width=this.el.offsetWidth,this.startX=this.startY=this.x=this.y=0,this.bindEvents()},setX:function(i){this.el.style[t.CSS.TRANSFORM]="translate3d("+i+"px,"+this.y+"px, 0)",this.x=i,this.startX=i},setY:function(i){this.el.style[t.CSS.TRANSFORM]="translate3d("+this.x+"px,"+i+"px, 0)",this.y=i,this.startY=i},setZIndex:function(t){this.el.style.zIndex=t},setWidth:function(t){this.el.style.width=t+"px"},setHeight:function(t){this.el.style.height=t+"px"},setPopInDuration:function(t){this.cardPopInDuration=t},transitionIn:function(t){var i=this
this.el.classList.add(t+"-start"),this.el.classList.add(t),this.el.style.display="block",setTimeout(function(){i.el.classList.remove(t+"-start")},100)},disableTransition:function(t){this.el.classList.remove(t)},swipe:function(){this.transitionOut()},snapBack:function(){this.onSnapBack(this.x,this.y,this.rotationAngle)},isUnderThreshold:function(){return Math.abs(this.thresholdAmount)<.4},transitionOut:function(i){var n=this
if(this.isUnderThreshold())return void n.onSnapBack(this.x,this.y,this.rotationAngle)
n.onTransitionOut(n.thresholdAmount)
{var e,r=Math.atan(i.gesture.deltaX/i.gesture.deltaY)
this.thresholdAmount<0?-1:1}e=this.x>0?this.parentWidth/2+this.width:-(this.parentWidth+this.width)
var o=e/Math.tan(r),s=(this.rotationAngle,.3-Math.min(Math.max(Math.abs(i.gesture.velocityX)/10,.05),.2))
t.requestAnimationFrame(function(){n.el.style.transform=n.el.style.webkitTransform="translate3d("+e+"px, "+o+"px,0) rotate("+n.rotationAngle+"rad)",n.el.style.transition=n.el.style.webkitTransition="all "+s+"s ease-in-out"}),setTimeout(function(){n.onDestroy&&n.onDestroy()},1e3*s)},bindEvents:function(){var i=this
t.onGesture("dragstart",function(n){t.requestAnimationFrame(function(){i._doDragStart(n)})},this.el),t.onGesture("drag",function(n){t.requestAnimationFrame(function(){i._doDrag(n)}),n.gesture.srcEvent.preventDefault()},this.el),t.onGesture("dragend",function(n){t.requestAnimationFrame(function(){i._doDragEnd(n)})},this.el)},_transformOriginLeft:function(){this.el.style[e]="left center",this.rotationDirection=1},_transformOriginRight:function(){this.el.style[e]="right center",this.rotationDirection=-1},_doDragStart:function(t){t.preventDefault()
var i=this.el.offsetWidth,n=window.innerWidth/2+this.rotationDirection*(i/2),e=Math.abs(n-t.gesture.touches[0].pageX)
this.touchDistance=10*e},_doDrag:function(t){t.preventDefault()
var i=t.gesture.deltaX/-1e3
this.rotationAngle=Math.atan(i),this.x=this.startX+.8*t.gesture.deltaX,this.y=this.startY+.8*t.gesture.deltaY,this.el.style.transform=this.el.style.webkitTransform="translate3d("+this.x+"px, "+this.y+"px, 0) rotate("+(this.rotationAngle||0)+"rad)",this.thresholdAmount=this.x/(this.parentWidth/2)
var n=this
setTimeout(function(){n.onPartialSwipe(n.thresholdAmount)})},_doDragEnd:function(t){this.transitionOut(t)}})
angular.module("ionic.contrib.ui.tinderCards",["ionic"]).directive("tdCard",["$timeout",function(t){var i=function(t){t=Math.min(1,3*t)
var i=.11,n=.67,e=.41,r=.99
return Math.pow(1-t,3)*i+3*Math.pow(1-t,2)*t*n+3*(1-t)*t*t*e+Math.pow(t,3)*r}
return{restrict:"E",template:'<div class="td-card" ng-transclude></div>',require:"^tdCards",transclude:!0,scope:{onSwipeLeft:"&",onSwipeRight:"&",onTransitionLeft:"&",onTransitionRight:"&",onTransitionOut:"&",onPartialSwipe:"&",onSnapBack:"&",onDestroy:"&"},compile:function(n,e){return function(n,e,r,o){var s=e[0],l=s.querySelector(".no-text"),h=s.querySelector(".yes-text")
s.style.transform=s.style.webkitTransform="translate3d(0px, 0px, 0px)"
var c=new a({el:s,leftText:l,rightText:h,onPartialSwipe:function(e){o.partial(e)
var r=this
t(function(){0>e?(r.leftText&&(r.leftText.style.opacity=i(-e)),r.rightText&&(r.rightText.style.opacity=0)):(r.leftText&&(r.leftText.style.opacity=0),r.rightText&&(r.rightText.style.opacity=i(e))),n.onPartialSwipe({amt:e})})},onSwipeRight:function(){t(function(){n.onSwipeRight()})},onSwipeLeft:function(){t(function(){n.onSwipeLeft()})},onTransitionRight:function(){t(function(){n.onTransitionRight()})},onTransitionLeft:function(){t(function(){n.onTransitionLeft()})},onTransitionOut:function(i){0>i?c.onTransitionLeft():c.onTransitionRight(),t(function(){n.onTransitionOut({amt:i})})},onDestroy:function(){t(function(){n.onDestroy()})},onSnapBack:function(i,e,r){{var o=s.querySelector(".yes-text"),a=s.querySelector(".no-text")
collide.animation({duration:500,percent:0,reverse:!1}).easing({type:"spring",frequency:15,friction:250,initialForce:!1}).on("step",function(t){s.style.transform=s.style.webkitTransform="translate3d("+(i-i*t)+"px, "+(e-e*t)+"px, 0) rotate("+(r-r*t)+"rad)",a&&(a.style.opacity=0),o&&(o.style.opacity=0)}).start()}t(function(){n.onSnapBack()})}})
n.$parent.swipeCard=c}}}}]).directive("tdCards",["$rootScope","$timeout",function(t,i){return{restrict:"E",template:'<div class="td-cards" ng-transclude></div>',transclude:!0,scope:{},controller:["$scope","$element",function(t,n){var e,r,o,s,a,l,h,c=function(){for(a=n[0].querySelectorAll("td-card"),h=0;h<a.length;h++)l=a[h],l&&(l.style.zIndex=a.length-h)}
i(function(){c()})
var u=function(t,i,n){}
this.partial=function(t){e=n[0].querySelectorAll("td-card"),r=e[0],o=e.length>2&&e[1],s=e.length>3&&e[2],o&&u(o,t,4),s&&u(s,t,8)}}]}}]).factory("TDCardDelegate",["$rootScope",function(t){return{popCard:function(i,n){t.$emit("tdCard.pop",n)},getSwipeableCard:function(t){return t.swipeCard}}}])}(window.ionic)
